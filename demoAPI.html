<!DOCTYPE html>
<html lang="zh-Hant">
  <head>
    <meta charset="UTF-8" />
    <title>天氣預報 (36 小時)</title>
    <style>
      /* 宇宙風背景 */
      body {
        margin: 0;
        font-family: "Noto Sans TC", sans-serif;
        background: radial-gradient(circle at center, #0d1b2a, #000000);
        color: #ffffff;
        min-height: 100vh;
        background-image: url("https://www.transparenttextures.com/patterns/stardust.png");
      }

      .container {
        max-width: 900px;
        margin: 0 auto;
        padding: 20px;
        text-align: center;
      }

      h1 {
        font-size: 2em;
        margin-bottom: 20px;
        text-shadow: 0 0 10px #00e1ff;
      }

      .weather-item {
        border: 1px solid rgba(255, 255, 255, 0.3);
        border-radius: 12px;
        padding: 15px;
        margin: 15px 0;
        background: rgba(255, 255, 255, 0.05);
        box-shadow: 0 0 15px rgba(0, 200, 255, 0.3);
        text-align: left;
      }

      .weather-item h3 {
        margin: 0 0 10px 0;
        color: #00e1ff;
      }

      .btn-container {
        margin-top: 20px;
      }

      .btn {
        display: inline-block;
        margin: 5px;
        padding: 10px 20px;
        background: #00e1ff;
        color: #000;
        text-decoration: none;
        border-radius: 8px;
        transition: 0.3s;
      }

      .btn:hover {
        background: #009ecf;
        color: #fff;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>未來 36 小時各區天氣預報</h1>
      <div id="weatherList">載入中…</div>
      <div class="btn-container">
        <a class="btn" href="javascript:history.back()">上一頁</a>
        <a class="btn" href="index.html">回首頁</a>
      </div>
    </div>

    <script>
      const apiUrl =
        "https://opendata.cwa.gov.tw/api/v1/rest/datastore/F-C0032-001?Authorization=CWB-FE4AD205-4642-40AD-B7FD-336A53D1ED2A";
      const weatherList = document.getElementById("weatherList");

      async function loadWeather() {
        try {
          const resp = await fetch(apiUrl);
          if (!resp.ok) throw new Error(`HTTP 錯誤：${resp.status}`);
          const data = await resp.json();
          const locations = data.records.location;
          if (!locations || !locations.length) {
            weatherList.textContent = "未取得任何天氣資料";
            return;
          }

          weatherList.innerHTML = "";

          locations.forEach((loc) => {
            const item = document.createElement("div");
            item.className = "weather-item";

            const area = document.createElement("h3");
            area.textContent = loc.locationName;
            item.appendChild(area);

            // 取第一個 time 節點
            function getParam(name) {
              const e = loc.weatherElement.find(
                (el) => el.elementName === name
              );
              return e && e.time && e.time[0]
                ? e.time[0].parameter.parameterName
                : "—";
            }

            const wx = getParam("Wx");
            const maxT = getParam("MaxT");
            const minT = getParam("MinT");
            const ci = getParam("CI");
            const pop = getParam("PoP");

            const info = document.createElement("p");
            info.innerHTML = `
              🌤️ 天氣：${wx}<br>
              🌡️ 溫度：${minT}°C ~ ${maxT}°C<br>
              😌 舒適度：${ci}<br>
              ☔ 降雨機率：${pop}%
            `;
            item.appendChild(info);

            weatherList.appendChild(item);
          });
        } catch (err) {
          weatherList.textContent = "載入失敗：" + err.message;
        }
      }

      loadWeather();
    </script>
  </body>
</html>

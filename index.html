<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Vincent Hu's Quantum Space</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">

  <style>
    html, body { margin:0; padding:0; height:100%; }
    body {
      font-family: "Poppins","微軟正黑體", Arial, sans-serif;
      background: #000;
      color: #fff;
      overflow: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100vh;
    }

    canvas#stars {
      position: fixed; inset: 0;
      width: 100%; height: 100%;
      z-index: 0;
      display: block;
      background: radial-gradient(ellipse at center, #02020a 0%, #000 90%);
    }

    .container {
      position: relative;
      z-index: 10;
      background: rgba(255,255,255,0.06);
      padding: 36px 52px;
      border-radius: 18px;
      backdrop-filter: blur(8px);
      text-align: center;
      box-shadow: 0 18px 50px rgba(0,0,0,0.6);
      max-width: 1024px;
      width: calc(100% - 48px);
    }

    h1 {
      margin:0 0 18px 0;
      font-size:2.4rem;
      color:#ffd580;
      text-shadow:0 0 14px rgba(255,160,50,0.45);
    }

    .links {
      display:flex; gap:10px; justify-content:center; flex-wrap:wrap;
    }
    .links a {
      text-decoration:none; color:#fff;
      background:linear-gradient(135deg,#ff7a18,#ffb347);
      padding:10px 18px; border-radius:12px;
      font-weight:600;
      transition: transform .15s ease, opacity .15s ease;
    }
    .links a:hover { transform: translateY(-1px); opacity: .95; }
    .links a.active {
      box-shadow: 0 0 0 2px rgba(255,255,255,.2) inset,
                  0 10px 24px rgba(255,140,0,.35);
    }

    .content-box {
      margin-top: 20px; padding: 20px;
      background: rgba(255,255,255,0.05);
      border-radius: 12px; text-align: left;
      max-height: 60vh; overflow-y: auto;
      backdrop-filter: blur(4px);
      opacity: 0; transition: opacity 0.4s ease; /* 預設透明，切換時漸顯 */
    }
    .content-box.show { opacity: 1; } /* 載入完成時加上 */

    /* 載入中 spinner */
    .loader {
      border: 4px solid rgba(255,255,255,0.1);
      border-left-color: #ffd580;
      border-radius: 50%;
      width: 32px; height: 32px;
      animation: spin 1s linear infinite;
      margin: 20px auto;
    }
    @keyframes spin { to { transform: rotate(360deg); } }

    .sr-only { position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,1px,1px); white-space:nowrap; border:0; }
  </style>
</head>
<body>

<canvas id="stars"></canvas>

<div class="container" role="main" aria-labelledby="site-title">
  <h1 id="site-title">🌌 Vincent Hu's Quantum Space</h1>
  <p class="sr-only" aria-live="polite" id="status">已載入頁面</p>

  <div class="links">
    <a href="VincentHU.html" class="nav-link">👤 自我簡介</a>
    <a href="TestTalk.html" class="nav-link">💬 聊天紀錄</a>
    <a href="TestGame.html" class="nav-link">🎮 小遊戲</a>
    <a href="TestVideo.html" class="nav-link">🎬 熱門影片</a>
  </div>

  <div id="content" class="content-box">請從上方選擇一個項目或使用網址 #hash 直接開啟。</div>
</div>

<script>
  const content = document.getElementById('content');
  const statusEl = document.getElementById('status');
  const navLinks = Array.from(document.querySelectorAll('.nav-link'));
  const firstLinkHref = navLinks[0]?.getAttribute('href') || '';

  function setActive(url){
    navLinks.forEach(a=>{
      const href = a.getAttribute('href');
      const isActive = url.endsWith(href);
      a.classList.toggle('active', isActive);
      if(isActive) a.setAttribute('aria-current','page');
      else a.removeAttribute('aria-current');
    });
  }

  async function loadPage(url, pushState = true){
    try {
      statusEl.textContent = '載入中…';
      content.classList.remove('show');
      content.innerHTML = '<div class="loader"></div>'; // spinner

      const res = await fetch(url, { cache: 'no-cache' });
      if(!res.ok) throw new Error('HTTP ' + res.status);
      const html = await res.text();

      injectHTMLWithScripts(html, content);
      setTimeout(()=> content.classList.add('show'), 50); // 延遲加 class，觸發淡入
      statusEl.textContent = '已載入：' + url;
      setActive(url);

      if(pushState) history.pushState({url}, '', '#' + url);
      content.focus(); // 移動焦點，無障礙支援
    } catch (err) {
      console.error(err);
      content.innerHTML = `<p>載入失敗 😢 (${String(err)})</p>
                           <button onclick="loadPage('${url}')">重試</button>`;
      statusEl.textContent = '載入失敗';
    }
  }

  function injectHTMLWithScripts(html, container){
    const tpl = document.createElement('template');
    tpl.innerHTML = html;
    const fragment = tpl.content.cloneNode(true);
    const scripts = Array.from(fragment.querySelectorAll('script'));
    scripts.forEach(s=> s.parentNode.removeChild(s));
    container.innerHTML = '';
    container.appendChild(fragment);
    scripts.forEach(oldScript=>{
      const newScript = document.createElement('script');
      for (const {name, value} of Array.from(oldScript.attributes))
        newScript.setAttribute(name, value);
      newScript.textContent = oldScript.textContent;
      container.appendChild(newScript);
    });
  }

  navLinks.forEach(a=>{
    a.addEventListener('click', e=>{
      e.preventDefault();
      loadPage(a.getAttribute('href'), true);
    });
  });

  window.addEventListener('popstate', e=>{
    const url = e.state?.url || location.hash.slice(1) || firstLinkHref;
    if(url) loadPage(url, false);
  });

  (function boot(){
    const initial = location.hash.slice(1) || firstLinkHref;
    if(initial) {
      loadPage(initial, false);
      setActive(initial);
    }
  })();
</script>
</body>
</html>
